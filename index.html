<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>–ú–æ—Å—Ç –≤ –Ω–∞—à–µ –ª–µ—Ç–æ</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <link href='https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css' rel='stylesheet' />
  <style>
    /* –°—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
      color: #333;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      width: 100%;
      max-width: 600px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      overflow: hidden;
      position: relative;
    }
    header {
      background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
      padding: 20px;
      text-align: center;
    }
    header h1 {
      margin: 0;
      font-size: 1.8rem;
      color: #fff;
    }
    main {
      padding: 20px;
      text-align: center;
    }
    .section {
      display: none;
      animation: fadeIn 0.5s ease-in-out;
    }
    .active {
      display: block;
    }
    #mapContainer {
      height: 400px;
      margin: 20px 0;
      border-radius: 10px;
      overflow: hidden;
    }
    button {
      background: #ff69b4;
      color: #fff;
      border: none;
      padding: 12px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin: 10px 0;
      transition: transform 0.2s;
    }
    button:hover {
      transform: scale(1.05);
    }
    input {
      padding: 10px;
      margin: 10px 0;
      width: 80%;
      max-width: 300px;
      border: 2px solid #ff69b4;
      border-radius: 5px;
    }
    #quoteSection {
      margin: 20px 0;
      padding: 15px;
      background: #fff3f8;
      border-radius: 10px;
      min-height: 100px;
    }
    #quoteText {
      font-style: italic;
      margin: 10px 0;
      color: #e91e63;
    }
    #controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 15px;
    }
    #congratulation {
      background: linear-gradient(135deg, #ff758c 0%, #ff7eb3 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }
    .hearts {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    .heart {
      position: absolute;
      animation: float 3s infinite;
      opacity: 0.7;
    }
    @keyframes float {
      0% { transform: translateY(0) rotate(45deg); }
      50% { transform: translateY(-20px) rotate(45deg); }
      100% { transform: translateY(0) rotate(45deg); }
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="hearts" id="hearts"></div>
    
    <!-- –ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ —Å 8 –º–∞—Ä—Ç–∞ -->
    <div id="congratulation" class="section active">
      <h2>üíê –° 8 –ú–∞—Ä—Ç–∞, –º–æ—è –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞—è! üíê</h2>
      <p>
        –¢—ã ‚Äî —Å–∞–º–∞—è —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–∞—è –∂–µ–Ω—â–∏–Ω–∞ –Ω–∞ —Å–≤–µ—Ç–µ!<br>
        –°–ø–∞—Å–∏–±–æ, —á—Ç–æ —Ç—ã –µ—Å—Ç—å –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏!<br>
        üå∏ –¢–≤–æ—è —É–ª—ã–±–∫–∞ –¥–µ–ª–∞–µ—Ç –º–∏—Ä —è—Ä—á–µ üå∏
      </p>
      <button onclick="startJourney()">–ü—Ä–∏–Ω—è—Ç—å –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ üíñ</button>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div id="mainContent" style="display: none;">
      <header>
        <h1>–ú–æ—Å—Ç –≤ –Ω–∞—à–µ –ª–µ—Ç–æ üåâ</h1>
      </header>
      
      <div id="mapContainer"></div>

      <main>
        <!-- –°—Ç–∞—Ä—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
        <div id="start" class="section">
          <p>–ü–æ—Å—Ç—Ä–æ–∏–º –º–æ—Å—Ç –æ—Ç –°—Ç–∞–º–±—É–ª–∞ –¥–æ –¢—É—Ä–∫–º–µ–Ω–∞–±–∞–¥–∞ —á–µ—Ä–µ–∑ –Ω–∞—à–∏ –æ–±—â–∏–µ –º–µ—á—Ç—ã!</p>
          <button onclick="startConstruction()">–ù–∞—á–∞—Ç—å —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ üõ†Ô∏è</button>
        </div>

        <!-- –í–æ–ø—Ä–æ—Å—ã -->
        <div id="questions" class="section">
          <h2>–≠—Ç–∞–ø —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ ‚Ññ<span id="currentStep">1</span></h2>
          <div id="questionContainer"></div>
          <input type="text" id="answerInput" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç...">
          <button onclick="checkAnswer()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å ‚û°Ô∏è</button>
          <p id="statusText"></p>
        </div>

        <!-- –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –±—É–∫–µ—Ç -->
        <div id="bouquetSection" class="section">
          <h2>–°–æ–±–µ—Ä–∏ —Å–≤–æ–π –±—É–∫–µ—Ç üíê</h2>
          <select id="flowerType">
            <option value="üåπ">–†–æ–∑—ã</option>
            <option value="üå∑">–¢—é–ª—å–ø–∞–Ω—ã</option>
            <option value="üå∏">–°–∞–∫—É—Ä–∞</option>
          </select>
          <button onclick="createBouquet()">–°–æ–∑–¥–∞—Ç—å ‚ú®</button>
          <div id="bouquetDisplay" style="margin: 20px 0; font-size: 2em"></div>
          <button onclick="end()">–ó–∞–≤–µ—Ä—à–∏—Ç—å üéâ</button>
        </div>

        <!-- –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ -->
        <div id="final" class="section">
          <h2>üéâ –ú–æ—Å—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω! üéâ</h2>
          <div id="quoteSection">
            <div id="quoteText"></div>
            <div id="controls">
              <button onclick="changeQuote()">–ù–æ–≤–∞—è —Ü–∏—Ç–∞—Ç–∞ üîÑ</button>
              <button onclick="showSection('bouquetSection')">–ò–∑–º–µ–Ω–∏—Ç—å –±—É–∫–µ—Ç üíê</button>
            </div>
          </div>
          <p>–î–æ –Ω–∞—à–µ–π –≤—Å—Ç—Ä–µ—á–∏ –æ—Å—Ç–∞–ª–æ—Å—å: ‚è≥<span id="daysCounter"></span></p>
          <button onclick="resetProgress()">–ù–∞—á–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ üîÅ</button>
        </div>
      </main>
    </div>
  </div>

  <script src='https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.js'></script>

  <script>
    let map, bridgeLayerId = 'bridge-line';
    const targetDate = new Date('2025-07-01T00:00:00');
    const quotes = [
      "¬´–¢—ã —Ç–∞–∫ –¥–∞–ª–µ–∫–æ, –Ω–æ —è —Å —Ç–æ–±–æ–π ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –¥—Ä—É–≥–∞—è –≥–µ–æ–≥—Ä–∞—Ñ–∏—è¬ª (–ó–µ–º—Ñ–∏—Ä–∞)",
      "¬´–ú–µ–∂–¥—É –Ω–∞–º–∏ –∫–∏–ª–æ–º–µ—Ç—Ä—ã, –º–µ–∂–¥—É –Ω–∞–º–∏ —Å–ª–æ–≤–∞...¬ª (–ë–∏-2)",
      "¬´–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ ‚Äî —ç—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–æ, –ª—é–±–æ–≤—å ‚Äî –Ω–∞–≤—Å–µ–≥–¥–∞¬ª",
      "¬´–ú—ã –±—É–¥–µ–º –≤–º–µ—Å—Ç–µ, —è –∑–Ω–∞—é, –Ω–∞—Å –Ω–µ —Ä–∞–∑–ª—É—á–∞—Ç –∫–∏–ª–æ–º–µ—Ç—Ä—ã¬ª (–°–ø–ª–∏–Ω)",
      "¬´–õ—é–±–æ–≤—å ‚Äî —ç—Ç–æ –º–æ—Å—Ç —á–µ—Ä–µ–∑ –≤—Å–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è¬ª",
      "¬´–°–æ—Ç—Ä–∏ —Å–ª—É—á–∞–π–Ω—ã–µ —á–µ—Ä—Ç—ã ‚Äî –∏ —Ç—ã —É–≤–∏–¥–∏—à—å: –º–∏—Ä –ø—Ä–µ–∫—Ä–∞—Å–µ–Ω¬ª (–ê–∫–≤–∞—Ä–∏—É–º)",
      "¬´–¢—ã –¥–∞—Ä–∏—à—å –º–Ω–µ —Å–≤–µ—Ç –¥–∞–∂–µ –≤ —Å–∞–º—ã–π —Ç–µ–º–Ω—ã–π –¥–µ–Ω—å¬ª",
      "¬´–ö–∞–∂–¥—ã–π –º–∏–≥ —Å —Ç–æ–±–æ–π ‚Äì —ç—Ç–æ –≤–µ—á–Ω–æ—Å—Ç—å —Å—á–∞—Å—Ç—å—è¬ª",
      "¬´–í —Ç–≤–æ–∏—Ö –≥–ª–∞–∑–∞—Ö —è –≤–∏–∂—É –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ —Å–≤–æ–∏—Ö –º–µ—á—Ç–∞–Ω–∏–π¬ª",
      "¬´–° —Ç–æ–±–æ–π –∂–∏–∑–Ω—å –Ω–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–º—ã—Å–ª–æ–º –∏ –∫—Ä–∞—Å–æ—Ç–æ–π¬ª",
      "¬´–õ—é–±–æ–≤—å ‚Äì —ç—Ç–æ —è–∑—ã–∫, –ø–æ–Ω—è—Ç–Ω—ã–π –∫–∞–∂–¥–æ–º—É —Å–µ—Ä–¥—Ü—É¬ª",
      "¬´–¢—ã ‚Äì –º–æ–µ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ, –º–æ—è –º—É–∑–∞ –∏ –º–æ—è —Ä–∞–¥–æ—Å—Ç—å¬ª",
      "¬´–° —Ç–æ–±–æ–π —è —É—á—É—Å—å –ª—é–±–∏—Ç—å –º–∏—Ä –≤–æ–∫—Ä—É–≥ –µ—â–µ —è—Ä—á–µ¬ª",
      "¬´–¢—ã ‚Äì –∫–∞–∫ —É—Ç—Ä–µ–Ω–Ω—è—è —Ä–æ—Å–∞, —Å–≤–µ–∂–∞ –∏ –Ω–µ–∑–∞–±—ã–≤–∞–µ–º–∞¬ª",
      "¬´–õ—é–±–æ–≤—å –∫ —Ç–µ–±–µ ‚Äì —ç—Ç–æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –±–µ–∑ –∫–æ–Ω—Ü–∞¬ª",
      "¬´–¢—ã ‚Äì –º–æ—è –∑–≤–µ–∑–¥–∞, –æ—Å–≤–µ—â–∞—é—â–∞—è –º–æ–π –ø—É—Ç—å¬ª",
      "¬´–ö–∞–∂–¥—ã–π –¥–µ–Ω—å —Å —Ç–æ–±–æ–π ‚Äì —ç—Ç–æ –ø—Ä–∞–∑–¥–Ω–∏–∫ –¥–ª—è –¥—É—à–∏¬ª",
      "¬´–í —Ç–µ–±–µ —è –Ω–∞—à–µ–ª –≤—Å–µ, —á–µ–≥–æ –∏—Å–∫–∞–ª –≤ —ç—Ç–æ–º –º–∏—Ä–µ¬ª",
      "¬´–¢—ã –¥–µ–ª–∞–µ—à—å –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç –º–æ–µ–π –∂–∏–∑–Ω–∏ –æ—Å–æ–±–µ–Ω–Ω—ã–º¬ª",
      "¬´–° —Ç–æ–±–æ–π –¥–∞–∂–µ –º–æ–ª—á–∞–Ω–∏–µ –∑–≤—É—á–∏—Ç –∫–∞–∫ –º—É–∑—ã–∫–∞¬ª",
      "¬´–õ—é–±–æ–≤—å ‚Äì —ç—Ç–æ –∫–æ–≥–¥–∞ —Å—á–∞—Å—Ç—å–µ –¥—Ä—É–≥–æ–≥–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–≤–æ–∏–º¬ª",
      "¬´–¢—ã ‚Äì —Å–∞–º—ã–π —Ç–µ–ø–ª—ã–π –∏ –Ω–µ–∂–Ω—ã–π –ª—É—á–∏–∫ —Å–≤–µ—Ç–∞¬ª",
      "¬´–¢—ã ‚Äì –º–æ–µ —É—Ç—Ä–æ, –¥–µ–Ω—å –∏ –≤–µ—á–µ—Ä, –º–æ—è –≤–µ—á–Ω–æ—Å—Ç—å¬ª",
      "¬´–° —Ç–æ–±–æ–π –ª—é–±–∞—è –±—É—Ä—è –∫–∞–∂–µ—Ç—Å—è —Ç–∏—Ö–æ–π –∏ —Å–ø–æ–∫–æ–π–Ω–æ–π¬ª",
      "¬´–õ—é–±–æ–≤—å ‚Äî —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –º—ã —Ç–≤–æ—Ä–∏–º –≤–º–µ—Å—Ç–µ¬ª",
      "¬´–¢—ã ‚Äì –º–æ—è –ª—é–±–∏–º–∞—è –º–µ–ª–æ–¥–∏—è –≤ —Ä–∏—Ç–º–µ –∂–∏–∑–Ω–∏¬ª",
      "¬´–° —Ç–æ–±–æ–π –º–∏—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —è—Ä—á–µ –∏ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–µ–µ¬ª",
      "¬´–¢—ã ‚Äî –º–æ—è —Å—É–¥—å–±–∞, –º–æ—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∏ –Ω–µ–ø–æ–≤—Ç–æ—Ä–∏–º–∞—è¬ª",
      "¬´–õ—é–±–æ–≤—å –ø—Ä–∏—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ —Ç—ã –º–µ–Ω—å—à–µ –≤—Å–µ–≥–æ –µ–µ –∂–¥–µ—à—å¬ª",
      "¬´–¢—ã ‚Äì –æ—Ç–≤–µ—Ç –Ω–∞ –≤—Å–µ –º–æ–∏ –º–æ–ª–∏—Ç–≤—ã¬ª",
      "¬´–ö–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —è –≤–∏–∂—É —Ç–µ–±—è, —Å–µ—Ä–¥—Ü–µ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–µ—Ç—å¬ª",
      "¬´–¢—ã ‚Äì –º–æ—è —Ä–∞–¥–æ—Å—Ç—å, –º–æ—è –º–µ—á—Ç–∞ –∏ –º–æ—è —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å¬ª",
      "¬´–° —Ç–æ–±–æ–π —è —É—á—É—Å—å –≤–µ—Ä–∏—Ç—å –≤ —á—É–¥–µ—Å–∞¬ª",
      "¬´–¢—ã —Å–ª–æ–≤–Ω–æ –≤–µ—Å–µ–Ω–Ω–∏–π –≤–µ—Ç–µ—Ä, –ø—Ä–∏–Ω–æ—Å—è—â–∏–π —Å–≤–µ–∂–µ—Å—Ç—å –≤ –º–æ—é –∂–∏–∑–Ω—å¬ª",
      "¬´–õ—é–±–æ–≤—å ‚Äì —ç—Ç–æ –∫–æ–≥–¥–∞ –¥–≤–∞ —Å–µ—Ä–¥—Ü–∞ –±—å—é—Ç—Å—è –≤ —É–Ω–∏—Å–æ–Ω¬ª",
      "¬´–¢—ã ‚Äì –º–æ—è –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∞—è –∏—Å—Ç–æ—Ä–∏—è, –º–æ–π –≤–µ—á–Ω—ã–π —Ä–æ–º–∞–Ω¬ª",
      "¬´–° —Ç–æ–±–æ–π –¥–∞–∂–µ –ø—Ä–æ—Å—Ç—ã–µ –º–≥–Ω–æ–≤–µ–Ω–∏—è —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –≤–æ–ª—à–µ–±–Ω—ã–º–∏¬ª",
      "¬´–¢—ã ‚Äî –º–æ–π –∞–Ω–≥–µ–ª-—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å –≤ –º–∏—Ä–µ —Å—É–µ—Ç—ã¬ª",
      "¬´–õ—é–±–æ–≤—å ‚Äì —ç—Ç–æ –∫–æ–≥–¥–∞ —Ç—ã –≤–∏–¥–∏—à—å —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ –≤ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–µ¬ª",
      "¬´–¢—ã ‚Äì –º–æ—è –Ω–µ–∂–Ω–æ—Å—Ç—å, –º–æ—è –ª–∞—Å–∫–∞ –∏ –º–æ—è –∫—Ä–µ–ø–æ—Å—Ç—å¬ª",
      "¬´–° —Ç–æ–±–æ–π —è –ø–æ–Ω—è–ª, —á—Ç–æ —Ç–∞–∫–æ–µ –Ω–∞—Å—Ç–æ—è—â–∞—è –ª—é–±–æ–≤—å¬ª",
      "¬´–¢—ã ‚Äì –º–æ–µ —Å–ø–∞—Å–µ–Ω–∏–µ, –º–æ—è –Ω–∞–¥–µ–∂–¥–∞ –∏ –º–æ–π –¥–æ–º¬ª",
      "¬´–õ—é–±–æ–≤—å –æ–∂–∏–≤–ª—è–µ—Ç –¥—É—à—É –∏ –¥–∞—Ä–∏—Ç —Å–∏–ª—ã –º–µ—á—Ç–∞—Ç—å¬ª",
      "¬´–¢—ã ‚Äì –º–æ—è –∑–≤–µ–∑–¥–∞, –≤–µ–¥—É—â–∞—è –º–µ–Ω—è —á–µ—Ä–µ–∑ –Ω–æ—á—å¬ª",
      "¬´–° —Ç–æ–±–æ–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–º—ã—Å–ª–æ–º –∏ —á—É–¥–µ—Å–∞–º–∏¬ª",
      "¬´–¢—ã ‚Äì –º–æ–π —Ç–∏—Ö–∏–π –ø—Ä–∏–±–æ–π, –¥–∞—Ä—É—é—â–∏–π —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ¬ª",
      "¬´–õ—é–±–æ–≤—å ‚Äì —ç—Ç–æ —á—É–≤—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è—Ö¬ª",
      "¬´–¢—ã ‚Äì –º–æ—è –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–Ω–∞—è –ø–æ—ç–º–∞, –º–æ—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è —Å–∫–∞–∑–∫–∞¬ª",
      "¬´–° —Ç–æ–±–æ–π –¥–∞–∂–µ —Å–∞–º—ã–µ –æ–±—ã–¥–µ–Ω–Ω—ã–µ –¥–Ω–∏ –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —á—É–¥–µ—Å–∞¬ª",
      "¬´–¢—ã ‚Äì –ª—É—á—à–∞—è —á–∞—Å—Ç—å –º–æ–µ–π –∂–∏–∑–Ω–∏, –º–æ–µ –Ω–∞—Å—Ç–æ—è—â–µ–µ –∏ –±—É–¥—É—â–µ–µ¬ª"
    ];
    
    const questions = [
      { text: "–†–∞—Å—Å–∫–∞–∂–∏, –∫–∞–∫–∞—è —á–µ—Ä—Ç–∞ –≤ —Å–µ–±–µ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É —Å—á–∞—Å—Ç–ª–∏–≤–æ–π?", answer: "" },
      { text: "–ö–∞–∫–∞—è –∫–Ω–∏–≥–∞ –∏–ª–∏ —Ñ–∏–ª—å–º —Ç—Ä–æ–Ω—É–ª–∏ —Ç–≤–æ—é –¥—É—à—É –∏ –ø–æ—á–µ–º—É?", answer: "" },
      { text: "–ö–∞–∫–æ–µ —É —Ç–µ–±—è –ª—é–±–∏–º–æ–µ –±–ª—é–¥–æ –∏–ª–∏ –¥–µ—Å–µ—Ä—Ç?", answer: "" },
      { text: "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –∑–Ω–∞—á–∏—Ç —É—Ç—Ä–æ ‚Äì –∫–∞–∫ —Ç—ã –ª—é–±–∏—à—å –Ω–∞—á–∏–Ω–∞—Ç—å —Å–≤–æ–π –¥–µ–Ω—å?", answer: "" },
      { text: "–ö–∞–∫–∏–µ –º–µ—á—Ç—ã –∏ —Ü–µ–ª–∏ —Ç—ã —Å—á–∏—Ç–∞–µ—à—å —Å–∞–º—ã–º–∏ –≤–∞–∂–Ω—ã–º–∏ –≤ –∂–∏–∑–Ω–∏?", answer: "" },
      { text: "–†–∞—Å—Å–∫–∞–∂–∏ –æ –º–æ–º–µ–Ω—Ç–µ, –∫–æ–≥–¥–∞ —Ç—ã –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞–ª–∞ –Ω–∞—Å—Ç–æ—è—â—É—é –ª—é–±–æ–≤—å –∏–ª–∏ —Å—á–∞—Å—Ç—å–µ.", answer: "" },
      { text: "–ö–∞–∫–æ–π –∞—Ä–æ–º–∞—Ç –∏–ª–∏ –≤–∫—É—Å —Ç–µ–±–µ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –æ —Å–∞–º—ã—Ö —Ç–µ–ø–ª—ã—Ö –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è—Ö?", answer: "" },
      { text: "–ß—Ç–æ —Ç–µ–±—è –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –∏ –º–æ—Ç–∏–≤–∏—Ä—É–µ—Ç –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏?", answer: "" },
      { text: "–ö–∞–∫ —Ç—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—à—å –∏–¥–µ–∞–ª—å–Ω—ã–π –≤–µ—á–µ—Ä –∏–ª–∏ —Å–≤–∏–¥–∞–Ω–∏–µ?", answer: "" },
      { text: "–ö–∞–∫–∏–µ —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏–ª–∏ —Ä–∏—Ç—É–∞–ª—ã –¥–ª—è —Ç–µ–±—è –æ—Å–æ–±–µ–Ω–Ω–æ –∑–Ω–∞—á–∏–º—ã?", answer: "" },
      { text: "–†–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ –¥–ª—è —Ç–µ–±—è –∑–Ω–∞—á–∏—Ç –±—ã—Ç—å –ª—é–±–∏–º–æ–π –∏ –∫–∞–∫ —Ç—ã —ç—Ç–æ —á—É–≤—Å—Ç–≤—É–µ—à—å?", answer: "" }
    ];
    
    function createHearts() {
      const heartsContainer = document.getElementById('hearts');
      const fragment = document.createDocumentFragment();
      
      for(let i = 0; i < 20; i++) {
        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.style.cssText = `
          left: ${Math.random() * 100}%;
          top: ${Math.random() * 100}%;
          animation-delay: ${Math.random() * 2}s;
        `;
        heart.innerHTML = '‚ù§Ô∏è';
        fragment.appendChild(heart);
      }
      heartsContainer.appendChild(fragment);
    }

    // –£–ø—Ä–æ—â–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    function saveProgress() {
      const data = {
        currentQuestion,
        answers: questions.map(q => q.answer)
      };
      localStorage.setItem('bridgeProgress', JSON.stringify(data));
    }
    function end() {
      showSection('final');
    }
    // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    function loadProgress() {
      const saved = localStorage.getItem('bridgeProgress');
      if(!saved) return;

      const data = JSON.parse(saved);
      currentQuestion = data.currentQuestion;
      questions.forEach((q, i) => q.answer = data.answers[i] || '');

      document.getElementById('congratulation').classList.remove('active');
      document.getElementById('mainContent').style.display = 'block';
      
      // –û—Ç–ª–æ–∂–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
      setTimeout(() => {
        showCurrentSection();
        updateTimer();
        showQuote();
        if(map.loaded()) {
          updateBridge(currentQuestion / questions.length);
        }
      }, 100);
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã –æ–¥–∏–Ω —Ä–∞–∑
    
    function initMap() {
      map = new maplibregl.Map({
        container: 'mapContainer',
        style: 'https://demotiles.maplibre.org/style.json',
        center: [50.5, 39.5],
        zoom: 4,
        interactive: true
      });

      map.on('load', () => {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–∞—Ä—Ç—ã
        initMapElements();
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ—Å—Ç–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        if(localStorage.getItem('bridgeProgress')) {
          updateBridge(currentQuestion / questions.length);
        }
      });
    }

    function initMapElements() {
      map.addSource('bridge', {
        type: 'geojson',
        data: { type: 'FeatureCollection', features: [] }
      });

      map.addLayer({
        id: bridgeLayerId,
        type: 'line',
        source: 'bridge',
        layout: { 'line-cap': 'round' },
        paint: {
          'line-color': '#ff69b4',
          'line-width': 4,
          'line-dasharray': [2, 2]
        }
      });

      addMarker(28.9784, 41.0082, 'üè∞ –°—Ç–∞–º–±—É–ª');
      addMarker(63.6322911, 39.0954222, 'üåá –¢—É—Ä–∫–º–µ–Ω–∞–±–∞–¥');
    }

    function addMarker(lng, lat, title) {
      const el = document.createElement('div');
      el.className = 'marker';
      el.innerHTML = title;
      el.style.cssText = `
        font-size: 24px;
        cursor: pointer;
        transform: translate(-50%, -100%);
      `;

      new maplibregl.Marker(el)
        .setLngLat([lng, lat])
        .addTo(map);
    }

    function updateBridge(progress) {
      const start = [28.9784, 41.0082];
      const end = [63.6322911, 39.0954222];
      
      const currentPoint = [
        start[0] + (end[0] - start[0]) * progress,
        start[1] + (end[1] - start[1]) * progress
      ];

      const lineFeature = {
        type: 'Feature',
        geometry: {
          type: 'LineString',
          coordinates: [start, currentPoint]
        }
      };

      map.getSource('bridge').setData({
        type: 'FeatureCollection',
        features: [lineFeature]
      });

      // –ê–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
      const bounds = new maplibregl.LngLatBounds();
      bounds.extend(start);
      bounds.extend(currentPoint);
      map.fitBounds(bounds, { padding: 50 });
    }
    
    let currentQuestion = 0;
    function showQuestion() {
      // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ DOM
      requestAnimationFrame(() => {
        document.getElementById('questionContainer').innerHTML =
          `<p style="margin: 20px 0; font-size: 1.1rem;">${questions[currentQuestion].text}</p>`;
        document.getElementById('currentStep').textContent = currentQuestion + 1;
        document.getElementById('answerInput').value = '';
        document.getElementById('statusText').innerHTML = '';
        document.getElementById('answerInput').focus();
      });
    }

    function checkAnswer() {
      const answer = document.getElementById('answerInput').value.trim();
      if (answer) {
        questions[currentQuestion].answer = answer;
        currentQuestion++;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        requestAnimationFrame(() => {
          saveProgress();
          updateBridge(currentQuestion / questions.length);
          
          if (currentQuestion >= questions.length) {
            showSection('bouquetSection');
            
          } else {
            showQuestion();
          }
        });
      } else {
        document.getElementById('statusText').innerHTML =
          '<span style="color: #ff4081">‚úñ –ù–∞–ø–∏—à–∏ —Å–≤–æ–π –æ—Ç–≤–µ—Ç, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞</span>';
      }
    }
    
    // –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
    function startJourney() {
      document.getElementById('congratulation').classList.remove('active');
      document.getElementById('mainContent').style.display = 'block';
      showSection('start');
      saveProgress();
    }

    function startConstruction() {
      showSection('questions');
      showQuestion();
    }
    
    function resetProgress() {
      localStorage.removeItem('bridgeProgress');
      location.reload();
    }
    
    let currentQuoteIndex = 0;
    function showQuote() {
      document.getElementById('quoteText').textContent = quotes[currentQuoteIndex];
      currentQuoteIndex = (currentQuoteIndex + 1) % quotes.length;
    }
    
    function changeQuote() {
      showQuote();
    }
    
    function createBouquet() {
      const flowers = document.getElementById('flowerType').value.repeat(5);
      document.getElementById('bouquetDisplay').innerHTML = flowers;
    }
    
    function updateTimer() {
      function update() {
        const diff = targetDate - new Date();
        if(diff <= 0) {
          document.getElementById('daysCounter').textContent = "–í—Å—Ç—Ä–µ—á–∞ —Å–æ—Å—Ç–æ—è–ª–∞—Å—å! üíñ";
          return;
        }
        
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        document.getElementById('daysCounter').textContent = 
          `${days} –¥–Ω–µ–π –∏ ${hours} —á–∞—Å–æ–≤`;
      }
      
      update();
      setInterval(update, 1000 * 60); // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
    const WEBHOOK_URL = '	https://webhook.site/f39b1a0e-c982-4cbd-bace-b3ebb56ec8b4/';

    async function saveAnswersToServer() {
      try {
    // 1. –°–æ–∑–¥–∞–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –Ω–∏–∂–µ)
    const token = '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'; // –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—É–±–ª–∏–∫—É–π —ç—Ç–æ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ!
    
    // 2. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
    const answers = JSON.parse(localStorage.getItem('bridgeProgress'));
    const content = JSON.stringify(answers, null, 2);
    
    // 3. –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π Gist
    const response = await fetch('https://api.github.com/gists', {
      method: 'POST',
      headers: {
        'Authorization': `token ${token}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        description: "–û—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        public: false,
        files: {
          "answers1.json": {
            content: content
          }
        }
      })
    });

    if(response.ok) {
      console.log('Gist URL:');
    } else {
      console.log('‚õî –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + response.status);
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞:', error);
  }
    }
    
    function showSection(sectionId) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.getElementById(sectionId).classList.add('active');
      if (sectionId == 'bouquetSection') {
        saveAnswersToServer();
        } 
    }

    function showCurrentSection() {
      if(currentQuestion >= questions.length) {
        showSection('bouquetSection');
      } else if(currentQuestion > 0) {
        showSection('questions');
        showQuestion();
      } else {
        showSection('start');
      }
    }
    
    window.onload = () => {
      createHearts();
      initMap();
      loadProgress();
      showQuote();
      updateTimer();
      if (!localStorage.getItem('bridgeProgress')) {
        document.getElementById('mainContent').style.display = 'none';
        document.getElementById('congratulation').classList.add('active');
      } else {
        showQuote();
        updateTimer();
      }
    };
    
  </script>
</body>
</html>
